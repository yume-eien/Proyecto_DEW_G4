<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gracias por tu compra - Infinity Ascend Software">
    <title>Gracias por tu compra | Infinity Ascend Software</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/checkout.css">
    <link rel="icon" href="/assets/img/logos/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id="app" class="app">
        <!-- Selector de idioma flotante -->
        <!-- <div class="language-selector">
            <button class="language-btn active" data-lang="en">EN</button>
            <button class="language-btn" data-lang="es">ES</button>
            <button class="language-btn" data-lang="fr">FR</button>
        </div> -->

        <!-- Header con navegación -->
        <header class="main-header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <a href="/index.html">
                            <img src="/assets/img/logos/infinity-ascend-logo.svg" alt="Infinity Ascend Software" class="logo-img">
                        </a>
                    </div>
                    <nav class="main-nav">
                        <ul class="nav-list">
                            <li><a href="/index.html" class="nav-link" data-i18n="nav.home">Home</a></li>
                            <li><a href="/pages/catalog/index.html" class="nav-link" data-i18n="nav.products">Products</a></li>
                        <li><a href="/pages/support/index.html" class="nav-link" data-i18n="nav.support">Support</a></li>
                               <!--  <li><a href="/pages/user/dashboard.html" class="nav-link" data-i18n="nav.account">My Account</a></li> -->
                        </ul>
                    </nav>
                    <div class="header-actions">
                        <div class="cart-widget">
                            <a href="/pages/cart.html" class="cart-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                                <span class="cart-count">0</span>
                            </a>
                        </div>
                        <button class="mobile-menu-toggle">
                            <span></span>
                            <span></span>
                            <span></span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- Sección de agradecimiento -->
            <section class="thankyou-section">
                <div class="container">
                    <div class="thankyou-container">
                        <div class="thankyou-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                        </div>
                        
                        <h1 class="thankyou-title" data-i18n="thankyou.title">¡Gracias por tu compra!</h1>
                        <p class="thankyou-message" data-i18n="thankyou.message">Tu pedido ha sido procesado correctamente. Te hemos enviado un correo electrónico con los detalles de tu compra y las claves de licencia.</p>
                        
                        <div class="order-details">
                            <div class="order-details-header">
                                <span class="order-number" id="order-number">Pedido #12345</span>
                                <span class="order-date" id="order-date">15 Mayo, 2025</span>
                            </div>
                            
                            <div class="order-products" id="order-products">
                                <!-- Los productos comprados se insertan aquí mediante JS -->
                            </div>
                        </div>
                        
                        <div class="download-links">
                            <h3 data-i18n="thankyou.downloadTitle">Descargar Software</h3>
                            
                            <div id="download-items">
                                <!-- Los enlaces de descarga se insertan aquí mediante JS -->
                            </div>
                        </div>
                        
                        <div class="thankyou-actions">
                            <a href="/index.html" class="btn btn-outline" data-i18n="thankyou.backToHome">Volver al Inicio</a>
                            <a href="/pages/support/index.html" class="btn btn-primary" data-i18n="thankyou.supportCenter">Centro de Soporte</a>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="container">
                <div class="footer-grid">
                    <div class="footer-column">
                        <div class="footer-logo">
                            <img src="/assets/img/logos/infinity-ascend-logo-light.svg" alt="Infinity Ascend Software">
                        </div>
                        <p data-i18n="footer.description">Herramientas potentes y fáciles de usar para automatización y seguridad digital.</p>
                    </div>
                    <div class="footer-column">
                        <h4 data-i18n="footer.products">Productos</h4>
                        <ul class="footer-links">
                            <li><a href="/pages/products/autoflow/index.html" data-i18n="products.autoflow.title">Autoflow</a></li>
                            <li><a href="/pages/products/bulletproof/index.html" data-i18n="products.bulletproof.title">BulletProof</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4 data-i18n="footer.support">Soporte</h4>
                        <ul class="footer-links">
                            <li><a href="/pages/support/index.html" data-i18n="nav.support">Centro de Soporte</a></li>
                          <!--   <li><a href="/pages/support/refund.html" data-i18n="footer.refunds">Reembolsos</a></li> -->
                            <li><a href="/pages/legal/terms.html" data-i18n="footer.terms">Términos y Condiciones</a></li>
                            <li><a href="/pages/legal/privacy.html" data-i18n="footer.privacy">Política de Privacidad</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4 data-i18n="footer.contact">Contacto</h4>
                        <ul class="footer-links">
                            <li><a href="mailto:support@infinityascend.com">support@infinityascend.com</a></li>
                        </ul>
                        <div class="social-icons">
                            <a href="#" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                            <a href="#" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a>
                            <a href="#" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; <span id="current-year">2025</span> Infinity Ascend Software. <span data-i18n="footer.rights">Todos los derechos reservados.</span></p>
                    <div class="payment-methods">
                        <img src="/assets/img/logos/payment-paypal.svg" alt="PayPal" loading="lazy">
                        <img src="/assets/img/logos/payment-stripe.svg" alt="Stripe" loading="lazy">
                        <img src="/assets/img/logos/payment-crypto.svg" alt="Cryptocurrency" loading="lazy">
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="/assets/js/i18n.js"></script>
    <script src="/assets/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar datos del pedido desde sessionStorage
            const orderDataStr = sessionStorage.getItem('order_data');
            
            if (!orderDataStr) {
                // Si no hay datos de pedido, redirigir al inicio
                window.location.href = '/index.html';
                return;
            }
            
            try {
                const orderData = JSON.parse(orderDataStr);
                
                // Mostrar número de pedido y fecha
                document.getElementById('order-number').textContent = `Pedido #${orderData.orderNumber}`;
                
                // Formatear fecha
                const orderDate = new Date(orderData.orderDate);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('order-date').textContent = orderDate.toLocaleDateString(
                    window.i18n ? window.i18n.currentLanguage : 'en', 
                    options
                );
                
                // Mostrar productos comprados
                const productsContainer = document.getElementById('order-products');
                
                orderData.items.forEach((item, index) => {
                    // Encontrar la clave de licencia correspondiente
                    const productKey = orderData.productKeys.find(key => key.productId === item.id);
                    
                    const productElement = document.createElement('div');
                    productElement.className = 'order-product';
                    
                    productElement.innerHTML = `
                        <div class="order-product-image">
                            <img src="${item.image}" alt="${item.name}">
                        </div>
                        <div class="order-product-info">
                            <div class="order-product-name">${item.name} x${item.quantity}</div>
                            <div class="order-product-price">${window.infinityUtils.formatPrice(item.price * item.quantity)}</div>
                            ${productKey ? `
                                <div class="license-key">
                                    <span class="license-key-value">${productKey.key}</span>
                                    <button class="copy-key" data-key="${productKey.key}" data-i18n="thankyou.copyKey">Copiar</button>
                                </div>
                            ` : ''}
                        </div>
                    `;
                    
                    productsContainer.appendChild(productElement);
                });
                
                // Configurar botones para copiar claves
                const copyButtons = document.querySelectorAll('.copy-key');
                copyButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const key = this.getAttribute('data-key');
                        
                        // Copiar al portapapeles
                        navigator.clipboard.writeText(key).then(() => {
                            // Cambiar texto del botón temporalmente
                            const originalText = this.textContent;
                            this.textContent = window.i18n && window.i18n.initialized ? 
                                window.i18n.translate('thankyou.copied') : 
                                'Copiado!';
                            
                            // Restaurar texto original después de 2 segundos
                            setTimeout(() => {
                                this.textContent = originalText;
                            }, 2000);
                        });
                    });
                });
                
                // Mostrar enlaces de descarga
                const downloadContainer = document.getElementById('download-items');
                
                // Enlaces de descarga para cada producto
                const downloadLinks = {
                    'autoflow': {
                        windows: {
                            url: '/downloads/autoflow/autoflow-windows-latest.exe',
                            title: 'Autoflow para Windows',
                            size: '42 MB'
                        },
                        mac: {
                            url: '/downloads/autoflow/autoflow-mac-latest.dmg',
                            title: 'Autoflow para macOS',
                            size: '45 MB'
                        },
                        linux: {
                            url: '/downloads/autoflow/autoflow-linux-latest.deb',
                            title: 'Autoflow para Linux',
                            size: '38 MB'
                        }
                    },
                    'bulletproof': {
                        windows: {
                            url: '/downloads/bulletproof/bulletproof-windows-latest.exe',
                            title: 'BulletProof para Windows',
                            size: '28 MB'
                        },
                        mac: {
                            url: '/downloads/bulletproof/bulletproof-mac-latest.dmg',
                            title: 'BulletProof para macOS',
                            size: '30 MB'
                        },
                        linux: {
                            url: '/downloads/bulletproof/bulletproof-linux-latest.deb',
                            title: 'BulletProof para Linux',
                            size: '26 MB'
                        }
                    }
                };
                
                // Añadir enlaces de descarga para cada producto comprado
                const purchasedProducts = [];
                orderData.items.forEach(item => {
                    if (!purchasedProducts.includes(item.id) && downloadLinks[item.id]) {
                        purchasedProducts.push(item.id);
                        
                        // Detectar sistema operativo del usuario
                        let userOS = 'windows'; // Por defecto
                        if (navigator.userAgent.indexOf('Mac') !== -1) userOS = 'mac';
                        else if (navigator.userAgent.indexOf('Linux') !== -1) userOS = 'linux';
                        
                        // Añadir enlace de descarga para el SO del usuario
                        const download = downloadLinks[item.id][userOS];
                        
                        const downloadElement = document.createElement('div');
                        downloadElement.className = 'download-item';
                        
                        downloadElement.innerHTML = `
                            <div class="download-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                            </div>
                            <div class="download-info">
                                <div class="download-title">${download.title}</div>
                                <div class="download-description">${download.size}</div>
                            </div>
                            <a href="${download.url}" class="btn btn-primary download-btn" data-i18n="thankyou.download">Descargar</a>
                        `;
                        
                        downloadContainer.appendChild(downloadElement);
                        
                        // Añadir enlaces de descarga para otros sistemas operativos
                        Object.keys(downloadLinks[item.id]).forEach(os => {
                            if (os !== userOS) {
                                const altDownload = downloadLinks[item.id][os];
                                
                                const altDownloadElement = document.createElement('div');
                                altDownloadElement.className = 'download-item';
                                
                                altDownloadElement.innerHTML = `
                                    <div class="download-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                                    </div>
                                    <div class="download-info">
                                        <div class="download-title">${altDownload.title}</div>
                                        <div class="download-description">${altDownload.size}</div>
                                    </div>
                                    <a href="${altDownload.url}" class="btn btn-outline download-btn" data-i18n="thankyou.download">Descargar</a>
                                `;
                                
                                downloadContainer.appendChild(altDownloadElement);
                            }
                        });
                    }
                });
                
            } catch (error) {
                console.error('Error parsing order data:', error);
                window.location.href = '/index.html';
            }
        });
    </script>
</body>
</html>